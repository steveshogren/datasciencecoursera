normalize <- function(x) {
    return ((x - min(x)) / (max(x) - min(x)))
  }

chartit <-  function(df){
  plot(df$old, type="o", col="blue", axes=FALSE, ann=FALSE);
  lines(df$new, type="o", pch=22, lty=2, col="red");
  lines(df$bugs, type="o", pch=22, lty=2, col="green");
  axis(1, at=1:5, lab=c("C#","F#","Clojure","Javascript", "Coffeescript"))
  box()
  title(xlab="Language", col.lab=rgb(0,0,0))
  title(ylab="Score Magnitude", col.lab=rgb(0,0, 0))
  legend("topright", NULL, c("overfitted model","simpler model","av. bug/repo"), cex=0.8,
         col=c("blue","red", "green"), pch=21:22, lty=1:2);
}

## trimmed mean

## oldscores <- c(-70, 192, 24, -187, -115);
## newscores <- c(2, 8, 3, -3, -2);
## bugsperproj <- c(-107.43333,  -16.80000,  -10.48333, -101.25000,  -58.46667)
## bugsperproj <- c(-10.906667, -0.85714287, -1.3981482, -14.886666, -5.48)
## bugsperproj <- c(-32, -20, -3, -44, -23)
## bugsperproj <- c(-24, -3, -2, -44, -23)
## bugsperproj <- c(-15, -4, -3, -29, -7)
## oldscores <-   c(0,0,0,0,0, 0,0,0,0,0,0,0);
newscores <- c(2, 8, 3, -3, -2,  0,0,0,0,0,0,0);
oldscores <- c(-15,-4,-3,-29,-7,-7,-22,-13,-23,-5,-6,-12)
bugsperproj <- c(63,45,33,123,35,30,65,48,60,23,17,44)

df <- data.frame( "old" = oldscores, "new" = newscores, "bugs"=bugsperproj, stringsAsFactors = FALSE)
dfNorm <- as.data.frame(lapply(df, normalize))


## setwd("/home/jack/programming/datasciencecoursera")
## jpeg('rplot.jpg')
chartit(dfNorm)
## dev.off()

data<-data.frame(
csharp = c(13,0,205,7,124,17,11,105,43,139,60,0,0,19,4,0,0,22,406,46,1,17,1,0,24,34,37,35,0,2,5,0,16,9,21,17,0,26,0,3,18,0,12,4,13,0,145,0,13,0,0,0,0,0,0,81,0,0,2,15,8,49,16,0,60,1,10,13,0,0,1,2,25,0,0,6,19,12,3,0,37,104,0,0,0,13,0,19,12,0,20,5,0,0,3,2,0,0,0,20),
fsharp = c(0,0,6,0,3,7,0,221,0,3,0,0,6,2,36,2,3,0,0,6,0,2,0,0,0,0,0),
clojure = c(17,11,0,0,0,15,0,2,0,1,0,0,3,0,0,2,6,0,20,25,16,0,0,1,0,0,1,1,4,0,8,26,1,1,3,7,0,0,0,1,11,2,0,3,2,0,0,0,0,0,0,25,0,2,1,25,0,0,3,1,0,0,3,0,1,0,3,0,0,2,0,0,1,4,0,0,0,0,0,4,4,0,0,2,11,0,0,0,7,0,0,1,5,0,0,2,0,0,0,0),
js = c(0,0,1,0,0,1,739,66,17,105,136,8,24,25,8,96,39,0,0,0,0,10,61,0,30,0,285,68,1,12,103,49,0,0,5,3,39,39,0,29,51,27,9,5,15,24,65,10,0,64,21,202,63,0,0,0,0,0,33,14,164,300,4,27,41,25,113,0,44,12,0,37,4,14,4,24,24,50,3,0,0,97,0,23,993,241,0,2,24,0,0,19,0,8,29,117,2,0,22,297),
coffee = c(1236,0,93,6,515,0,4,3,0,24,105,0,7,1,15,0,0,6,123,27,0,0,1,0,72,4,24,0,132,0,0,0,7,27,0,13,10,1,10,0,1,2,0,3,0,0,0,0,9,0,0,0,18,5,4,0,2,0,6,0,0,0,5,0,1,22,4,0,0,2,5,9,0,0,16,28,5,0,3,1,0,0,67,0,0,0,0,91,0,5,4,4,12,7,1,0,1,0,0,0),
scala = c(0,149,0,7,39,362,0,0,215,0,11,1,53,0,0,2,15,0,1,0,0,5,27,3,0,13,1,0,3,0,73,27,0,3,23,1,31,6,0,22,26,0,0,0,0,4,0,9,0,52,9,4,7,0,2,3,1,43,0,1,6,2,13,1,8,21,0,4,5,0,5,18,0,0,1,2,0,10,7,2,0,0,0,7,0,61,9,0,0,0,1,1,0,0,35,4,0,6,0,1),
php = c(0,0,48,20,0,0,354,12,4858,0,8,0,0,99,21,7,14,170,2,21,0,51,313,0,332,0,0,0,11,42,2,46,0,48,0,0,12,10,0,0,31,22,2,107,0,0,55,0,0,9,3,0,0,0,277,0,0,2,0,1,91,0,0,8,52,2,17,0,14,2,0,0,0,71,0,0,3,0,10,0,6,45,0,0,123,0,28,0,16,0,0,3,36,2,0,18,0,0,0,7),
go = c(353,295,4,0,214,6,83,13,171,168,8,380,90,215,0,26,3,15,10,4,13,1,34,7,1,20,41,0,0,1,9,25,27,27,3,6,159,14,0,16,0,5,0,1,33,13,169,0,0,2,0,2,6,12,6,0,5,82,0,0,0,1,0,1,1,0,0,4,2,8,1,0,193,0,5,0,1,0,0,0,0,0,1,56,0,0,0,2,0,0,29,0,20,5,0,0,31,20,35,0),
java = c(0,261,0,143,0,4,136,0,7,1,0,3,0,1,10,11,61,107,28,17,4,19,0,7,0,5,81,37,0,0,107,0,6,0,0,0,14,4,0,54,399,88,1,0,0,0,1,0,3,0,0,4,7,0,75,0,0,5,3,0,5,983,95,0,0,0,340,17,0,0,2,0,4,2,198,1,40,68,6,54,1,0,0,161,0,652,0,33,69,0,0,4,119,0,235,0,5,3,0,0),
haskell = c(0,36,222,23,9,0,11,0,0,0,194,0,0,0,5,11,8,0,0,3,0,1,0,3,1,0,0,2,0,0,21,0,0,0,0,1,0,0,15,0,0,53,0,0,4,11,125,1,4,1,0,0,0,0,1,8,0,3,61,0,1,0,37,0,0,5,1,5,2,0,1,0,0,3,11,1,0,0,0,0,0,0,1,12,1,1,0,0,0,0,1,0,0,0,4,0,0,0),
ruby = c(0,1,88,12,0,4,113,0,0,0,10,0,18,20,0,2,21,0,3,1,0,1,11,38,3,14,1,0,18,0,28,1,3,145,5,0,0,11,3,54,0,0,37,0,0,2,0,0,0,0,2,0,0,2,7,3,1,30,39,19,5,1,1,6,8,0,0,0,1,0,2,17,0,85,0,0,0,4,7,1,5,4,0,2,0,0,11,2,8,1,3,0,1,0,73,0,0,0,0,0),
python = c(41,0,0,20,1,5,57,0,507,0,0,23,0,0,257,0,4,2,4,0,4,0,194,0,4,1,0,1,0,0,51,7,5,46,0,16,0,16,41,32,2,0,47,12,5,5,0,0,0,6,19,14,33,11,0,53,88,0,1,0,9,0,21,4,243,0,2,127,0,0,13,1,1,0,110,0,55,0,0,2,0,20,12,0,1,51,4,0,3,0,0,4,1,0,3,0,26,1,0,2))



bugs <- c(6446, 588, 629, 6075, 3508)
## repos <- c(300845, 4113,  29861, 1445782, 49051)
## with more than 5 stars
repos <- c(60, 35, 60, 60, 60)

p <- function(x, y) {
    (x/y);
}

df <- data.frame( "bugs" = bugs, "repos" = repos, stringsAsFactors = FALSE)
p(df$bugs, df$repos)
